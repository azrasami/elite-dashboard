<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<title>Elite Ads Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body {
  font-family: "Tajawal", sans-serif;
  background: #f3f4f6;
  margin: 0;
  padding: 20px;
  direction: rtl;
  text-align: right;
}

.container {
  max-width: 900px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.section-title {
  font-size: 22px;
  margin-bottom: 20px;
  text-align: center;
  color: #111827;
  font-weight: bold;
}

.filters {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-bottom: 25px;
  flex-wrap: wrap;
}

.filters input {
  padding: 7px 10px;
  border: 1px solid #d1d5db;
  border-radius: 5px;
  width: 250px;
}

.filters button {
  background: #111827;
  color: white;
  padding: 7px 15px;
  border-radius: 6px;
  cursor: pointer;
  border: none;
}

.campaigns-table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 10px;
  overflow: hidden;
}

.campaigns-table th, 
.campaigns-table td {
  padding: 12px;
  border-bottom: 1px solid #e5e7eb;
  text-align: center;
}

.good { color: #059669; font-weight: bold; }
.bad { color: #dc2626; font-weight: bold; }

.status {
  padding: 5px 10px;
  border-radius: 6px;
  color: white;
}

.status.active { background: #10b981; }
.status.paused { background: #6b7280; }
</style>
</head>

<body>

<div class="container">

  <h2 class="section-title">ğŸ“Š Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©</h2>

  <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙˆÙƒÙ† Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ -->
  <div class="filters">
    <input type="text" id="accountId" placeholder="Ù…Ø«Ø§Ù„: act_1234567890">
    <input type="text" id="userToken" placeholder="Ø£Ù„ØµÙ‚ÙŠ Ù‡Ù†Ø§ User Token">
    <button onclick="fetchCampaigns()">Ø¬Ù„Ø¨ Ø§Ù„Ø­Ù…Ù„Ø§Øª</button>
  </div>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ù…Ù„Ø§Øª -->
  <table class="campaigns-table">
    <thead>
      <tr>
        <th>Ø§Ø³Ù… Ø§Ù„Ø­Ù…Ù„Ø©</th>
        <th>Ø§Ù„Ù†ØªØ§Ø¦Ø¬</th>
        <th>Ø§Ù„ØªÙƒÙ„ÙØ©</th>
        <th>CPC</th>
        <th>ROAS</th>
        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
      </tr>
    </thead>
    <tbody id="campaignsBody">
      <tr><td colspan="6">Ø£Ø¯Ø®Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ø¶ØºØ·ÙŠ "Ø¬Ù„Ø¨ Ø§Ù„Ø­Ù…Ù„Ø§Øª"</td></tr>
    </tbody>
  </table>

</div>

<!-- ÙƒÙˆØ¯ Ø¬Ù„Ø¨ Ø§Ù„Ø­Ù…Ù„Ø§Øª -->
<script>

async function fetchCampaigns() {

  const ACCESS_TOKEN = document.getElementById("userToken").value.trim();
  const AD_ACCOUNT_ID = document.getElementById("accountId").value.trim();

  if (!ACCESS_TOKEN || !AD_ACCOUNT_ID) {
    alert("Ø±Ø¬Ø§Ø¡Ù‹ Ø£Ø¯Ø®Ù„ÙŠ Ø§Ù„Ù€ User Token Ùˆ Ad Account ID");
    return;
  }

  const url = `https://graph.facebook.com/v19.0/${AD_ACCOUNT_ID}/campaigns?fields=name,status,insights{spend,clicks,actions,cpc,roas}&access_token=${ACCESS_TOKEN}`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    if (!data.data) {
      document.getElementById("campaignsBody").innerHTML =
        `<tr><td colspan="6">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø­Ù…Ù„Ø§Øª.</td></tr>`;
      return;
    }

    renderTable(data.data);

  } catch (error) {
    document.getElementById("campaignsBody").innerHTML =
      `<tr><td colspan="6">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ API.</td></tr>`;
  }
}

// Ø±Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„
function renderTable(campaigns) {
  const body = document.getElementById("campaignsBody");
  body.innerHTML = "";

  campaigns.forEach(camp => {
    const insights = camp.insights ? camp.insights[0] : null;

    const results = insights?.actions?.find(a => a.action_type === "link_click")?.value || 0;
    const spend = insights?.spend || 0;
    const cpc = insights?.cpc || 0;
    const roas = insights?.roas?.[0]?.value || 0;

    const statusLabel = camp.status === "ACTIVE" 
      ? `<span class="status active">Ø´ØºØ§Ù„Ø©</span>` 
      : `<span class="status paused">Ù…ØªÙˆÙ‚ÙØ©</span>`;

    const roasClass = roas >= 1 ? "good" : "bad";

    body.innerHTML += `
      <tr>
        <td>${camp.name}</td>
        <td>${results}</td>
        <td>$${spend}</td>
        <td>$${cpc}</td>
        <td class="${roasClass}">${roas}</td>
        <td>${statusLabel}</td>
      </tr>
    `;
  });
}

</script>

</body>
</html>
